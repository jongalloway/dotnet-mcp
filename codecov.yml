# Codecov configuration for dotnet-mcp
# See: https://docs.codecov.com/docs/codecov-yaml

# Coverage thresholds and status checks
coverage:
  status:
    project:
      default:
        # Require overall project coverage to be maintained
        target: auto
        threshold: 1%
        # Only apply to changes (not absolute coverage)
        if_ci_failed: error

    patch:
      default:
        # Require new code to have reasonable coverage
        target: 70%
        threshold: 5%
        if_ci_failed: error

# Files and patterns to ignore in coverage reports
ignore:
  # Build artifacts and intermediate outputs
  - "**/obj/**"
  - "**/bin/**"
  
  # Auto-generated .NET files (compiler and SDK)
  - "**/*.g.cs"                          # Generated C# files (Regex, etc.)
  - "**/*.GlobalUsings.g.cs"             # Global usings auto-generated by SDK
  - "**/*.AssemblyInfo.cs"               # Assembly metadata auto-generated by SDK
  - "**/*.AssemblyAttributes.cs"         # Assembly attributes auto-generated by SDK
  
  # Source generator outputs
  - "**/generated/**"                    # Common generator output directory
  - "**/*Generator*/**/*.cs"             # Files in generator-specific directories
  
  # Test projects (we measure coverage of production code, not test code)
  - "**/*.Tests/**"
  - "**/Tests/**"

# Comment settings
comment:
  # Post coverage summary as PR comment
  layout: "diff, files"
  behavior: default
  require_changes: false
  require_base: no
  require_head: yes

# Additional options
codecov:
  # Wait for CI to complete before processing
  require_ci_to_pass: yes
  
  # Notify on coverage changes
  notify:
    wait_for_ci: yes
